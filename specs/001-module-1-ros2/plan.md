# Implementation Plan: Module 1 Content/Summary Tab Interface

**Branch**: `005-module-1-content-tabs` | **Date**: 2025-12-02 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-module-1-ros2/spec.md`

**Note**: This plan was generated by the `/sp.plan` command following the execution workflow in `.specify/templates/commands/plan.md`.

## Summary

Add dual-view tab interface to all 7 chapters in Module 1, allowing learners to toggle between full content (default) and condensed 1-2 page summaries (300-600 words). Technical approach uses Docusaurus built-in `@theme/Tabs` and `@theme/TabItem` components. Convert chapter files from `.md` to `.mdx` format and embed both Content and Summary in same file for single source of truth.

## Technical Context

**Language/Version**: JavaScript (Node.js 18+), MDX (Docusaurus 3.9.2)
**Primary Dependencies**: Docusaurus 3.9.2 (@docusaurus/preset-classic includes @theme/Tabs and @theme/TabItem), React 18+
**Storage**: Static markdown/MDX files in `book_frontend/docs/module-1/`, no database
**Testing**: Manual functional testing (tab switching, keyboard navigation), accessibility testing (NVDA/VoiceOver screen readers, keyboard-only navigation), Lighthouse performance audit
**Target Platform**: Web (browsers: Chrome, Firefox, Safari, Edge latest versions supporting CSS Grid, ES6, localStorage)
**Project Type**: Web - Docusaurus static site generator
**Performance Goals**: <2s page load on 10 Mbps connection, <1s tab switching, Lighthouse score >90
**Constraints**: WCAG 2.1 AA accessibility compliance, 300-600 word summaries, maintain consistency with existing Key Takeaways sections
**Scale/Scope**: 7 chapters in Module 1 only (pilot feature), ~3500 words of new summary content (500 words avg Ã— 7 chapters)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

âœ… **Simplicity First** (Principle 1): Uses Docusaurus built-in components, no custom React development
âœ… **Testable Requirements** (Principle 3): All requirements have clear acceptance criteria, word count targets measurable
âœ… **Accessibility by Design** (Principle 9): WCAG 2.1 AA compliance with keyboard navigation, ARIA roles, screen reader support
âœ… **No Premature Optimization** (Principle 8): Leverages existing Docusaurus tab infrastructure, no custom caching/optimization
âœ… **Documentation First** (Principle 39): Spec created before implementation, includes success criteria and validation checklist
âœ… **Single Source of Truth** (Principle 15): Both Content and Summary in same .mdx file to prevent sync issues

**No violations detected** - all constitutional principles satisfied.

## Project Structure

### Documentation (this feature)

```text
specs/001-module-1-ros2/
â”œâ”€â”€ spec.md              # Module 1 specification (merged with tab feature)
â”œâ”€â”€ plan.md              # This file (/sp.plan command output)
â”œâ”€â”€ research.md          # Phase 0 output (Docusaurus tabs research)
â”œâ”€â”€ data-model.md        # Phase 1 output (chapter structure, summary template)
â”œâ”€â”€ quickstart.md        # Phase 1 output (local dev setup, first tab implementation)
â”œâ”€â”€ checklists/          # Specification quality checklists
â”‚   â””â”€â”€ requirements.md
â”œâ”€â”€ contracts/           # Phase 1 output (summary content contract)
â”‚   â””â”€â”€ summary-content-contract.md
â””â”€â”€ tasks.md             # Phase 2 output (/sp.tasks command - NOT created by /sp.plan)
```

### Source Code (repository root)

```text
book_frontend/
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ module-1/
â”‚       â”œâ”€â”€ index.md                        # Module overview (no changes)
â”‚       â”œâ”€â”€ chapter-1-1-introduction.mdx    # CONVERTED from .md, tab interface added
â”‚       â”œâ”€â”€ chapter-1-2-pubsub.mdx          # CONVERTED from .md, tab interface added
â”‚       â”œâ”€â”€ chapter-1-3-custom-messages.mdx # CONVERTED from .md, tab interface added
â”‚       â”œâ”€â”€ chapter-1-4-services.mdx        # CONVERTED from .md, tab interface added
â”‚       â”œâ”€â”€ chapter-1-5-urdf.mdx            # CONVERTED from .md, tab interface added
â”‚       â”œâ”€â”€ chapter-1-6-rviz.mdx            # CONVERTED from .md, tab interface added
â”‚       â””â”€â”€ chapter-1-7-mini-project.mdx    # CONVERTED from .md, tab interface added
â”œâ”€â”€ docusaurus.config.ts                    # No changes (MDX already enabled)
â”œâ”€â”€ src/css/custom.css                      # Optional: custom tab styling if needed
â””â”€â”€ package.json                            # No changes (dependencies already present)

specs/
â””â”€â”€ 001-module-1-ros2/                      # Module 1 documentation (this directory)
```

**Structure Decision**: Web application structure with Docusaurus static site. All 7 chapter files in `book_frontend/docs/module-1/` will be converted from `.md` to `.mdx` format to support JSX tab components. No new directories needed - modifications only to existing chapter files.

## Complexity Tracking

> **This section is empty - no Constitution Check violations to justify.**

No complexity budget violations. Feature uses built-in Docusaurus capabilities without introducing new architectural patterns, dependencies, or abstractions.

---

# Phase 0: Research

See [research.md](./research.md) for detailed findings on:
- Docusaurus tab component API (@theme/Tabs, @theme/TabItem)
- MDX format requirements and frontmatter compatibility
- groupId persistence mechanism (localStorage sync across chapters)
- ARIA attributes for accessibility (role="tablist", aria-selected, etc.)
- Performance characteristics of tab rendering

**Key Finding**: Docusaurus 3.9.2 includes fully-featured tab support in @docusaurus/theme-classic preset. No additional packages needed. ARIA roles and keyboard navigation built-in.

---

# Phase 1: Design

## Data Model

See [data-model.md](./data-model.md) for complete chapter and summary structures.

**Chapter File Structure (MDX)**:
```jsx
---
id: chapter-1-2-pubsub
title: "Chapter 1.2: Publishers & Subscribers"
sidebar_position: 2
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<Tabs defaultValue="content" groupId="chapter-view">
  <TabItem value="content" label="Content" default>

    # Chapter 1.2: Your First ROS 2 Node - Publishers & Subscribers

    [Full chapter content here]

  </TabItem>
  <TabItem value="summary" label="Summary">

    ## Quick Summary

    [300-600 word summary here]

  </TabItem>
</Tabs>
```

**Summary Content Template**:
- Learning Objectives Recap (3-4 bullets)
- Core Concepts (3-5 definitions, 2-3 sentences each)
- Essential Commands/Code (2-3 examples max, syntax highlighted)
- Key Diagram (1-2 images)
- Quick Check (self-assessment checklist)
- Prerequisites for Next Chapter (2-3 items)

**Word Count Targets**:
- Chapter 1.1: 400-450 words
- Chapter 1.2: 500-550 words
- Chapter 1.3: 450-500 words
- Chapter 1.4: 450-500 words
- Chapter 1.5: 550-600 words
- Chapter 1.6: 400-450 words
- Chapter 1.7: 300-400 words

## API Contracts

See [contracts/summary-content-contract.md](./contracts/summary-content-contract.md) for detailed summary content requirements.

**Summary Content Contract**:
- Input: Existing chapter content with Key Takeaways section
- Output: 300-600 word summary extracted from Key Takeaways
- Validation: Word count tool, accessibility audit, readability check
- Format: Markdown with syntax-highlighted code blocks, alt text for images

**Tab Interface Contract**:
- Component: Docusaurus @theme/Tabs + @theme/TabItem
- Props: `defaultValue="content"`, `groupId="chapter-view"`
- Accessibility: ARIA roles (role="tablist", role="tab", role="tabpanel"), keyboard navigation (Tab/Shift+Tab, Enter/Space)
- Performance: <1s render time, no layout shift

## Quickstart

See [quickstart.md](./quickstart.md) for step-by-step local development setup.

**Quick Setup**:
1. Ensure Node.js 18+ and npm installed
2. Navigate to `book_frontend/` directory
3. Run `npm install` (if not already done)
4. Run `npm start` to launch dev server
5. Open browser to `http://localhost:3000`
6. Make changes to chapter .mdx files
7. Browser auto-reloads with changes

**First Tab Implementation** (Prototype with Chapter 1.2):
1. Rename `chapter-1-2-pubsub.md` to `chapter-1-2-pubsub.mdx`
2. Add imports after frontmatter: `import Tabs from '@theme/Tabs';` and `import TabItem from '@theme/TabItem';`
3. Wrap content in `<Tabs>` and `<TabItem>` components
4. Write 500-word summary in Summary tab
5. Test: verify tabs render, switch correctly, keyboard navigation works
6. Get approval before rolling out to remaining chapters

---

# Phase 2: Implementation Plan

## Phased Rollout Strategy

### Phase 2.1: Prototype (Chapter 1.2) - 4-6 hours
**Goal**: Validate approach with single chapter before full rollout

**Tasks**:
1. Convert `chapter-1-2-pubsub.md` to `.mdx` format
2. Add tab imports and wrap content structure
3. Write 500-550 word summary extracting from Key Takeaways
4. Test locally:
   - Both tabs render without errors
   - Default tab is "Content"
   - Can switch tabs with mouse clicks
   - Keyboard navigation works (Tab/Shift+Tab, Enter/Space)
   - Images and code blocks display in both tabs
   - Screen reader announces tab labels (test with NVDA or VoiceOver)
5. Run Lighthouse audit (target: >90 score)
6. Get user approval before proceeding

**Success Criteria**:
- âœ… Chapter 1.2 renders with working Content/Summary tabs
- âœ… Summary is 500-550 words (verified with word count)
- âœ… Passes keyboard accessibility test
- âœ… Passes screen reader test
- âœ… Lighthouse score >90

### Phase 2.2: Core Chapters (1.1, 1.3, 1.4, 1.5) - 12-16 hours
**Goal**: Roll out to 4 main content chapters

**Tasks for Each Chapter**:
1. Rename `.md` to `.mdx`
2. Add tab imports
3. Wrap content in tab structure
4. Write summary (extract from Key Takeaways, target word counts)
5. Test individual chapter (functional, accessibility)
6. Commit after each chapter (incremental progress)

**Chapter Specific Requirements**:
- Chapter 1.1: 400-450 words (Physical AI definition, ROS 2 graph, installation)
- Chapter 1.3: 450-500 words (custom messages, .msg syntax, colcon build)
- Chapter 1.4: 450-500 words (topics vs services, .srv syntax)
- Chapter 1.5: 550-600 words (URDF structure, joint types, kinematic tree)

**Success Criteria**:
- âœ… All 4 chapters have working tabs
- âœ… All summaries meet word count targets
- âœ… No broken links or images
- âœ… Code syntax highlighting works

### Phase 2.3: Final Chapters (1.6, 1.7) - 6-8 hours
**Goal**: Complete remaining chapters and full regression testing

**Tasks**:
1. Convert Chapter 1.6 (RViz2) with 400-450 word summary
2. Convert Chapter 1.7 (Mini-Project) with 300-400 word summary
3. Full regression testing across all 7 chapters:
   - All tabs render correctly
   - Tab selection persists across chapters (groupId sync)
   - Keyboard navigation works consistently
   - Screen reader compatibility verified
   - No performance degradation
4. Run Lighthouse audit on all chapters
5. Verify all summaries extract from Key Takeaways sections

**Success Criteria**:
- âœ… All 7 chapters complete with working tabs
- âœ… groupId persistence works (select Summary in Ch 1.1, opens Ch 1.2 to Summary)
- âœ… All Lighthouse scores >90
- âœ… All accessibility tests pass

### Phase 2.4: Documentation - 2-4 hours
**Goal**: Document pattern for future use in Modules 2-4

**Tasks**:
1. Create `docs/tab-pattern-guide.md` with:
   - When to use tabs (multi-view content)
   - How to implement (step-by-step with code examples)
   - Summary writing guidelines (extraction process, word counts, templates)
   - Accessibility checklist
2. Update project README with tab feature mention
3. Add comments in code linking Summary to Key Takeaways source

**Success Criteria**:
- âœ… Documentation complete for future implementers
- âœ… Pattern reusable for Modules 2-4 if needed

---

# Phase 3: Testing and Validation

## Functional Testing Checklist

**For Each Chapter**:
- [ ] Chapter renders without errors
- [ ] Both Content and Summary tabs display correctly
- [ ] Default tab is "Content" on first load
- [ ] Can switch tabs with mouse clicks
- [ ] Tab switching is instant (<1s)
- [ ] No layout shift when switching tabs
- [ ] Images display in both tabs
- [ ] Code syntax highlighting works in both tabs
- [ ] No broken links in either tab

**Cross-Chapter Testing**:
- [ ] Tab selection persists via groupId (select Summary in Ch 1.1, Ch 1.2 opens to Summary)
- [ ] Can navigate through all 7 chapters without errors
- [ ] Browser back button works correctly with tab state

## Accessibility Testing Checklist

**Keyboard Navigation**:
- [ ] Tab key moves focus to tab list
- [ ] Arrow keys navigate between tabs
- [ ] Enter or Space key activates selected tab
- [ ] Focus indicator visible on active tab (3:1 contrast ratio)
- [ ] Can navigate through entire chapter with keyboard only

**Screen Reader Testing** (NVDA on Windows OR VoiceOver on macOS):
- [ ] Tab list announced with "tablist" role
- [ ] Each tab announced with label ("Content" or "Summary")
- [ ] Active tab state announced (aria-selected)
- [ ] Tab panel content readable
- [ ] No confusing or missing context

**Visual Accessibility**:
- [ ] Tab labels clearly distinguish "Content" vs "Summary" (not color-only)
- [ ] Focus indicator meets 3:1 contrast ratio
- [ ] Text in both tabs meets 4.5:1 contrast ratio (WCAG AA)
- [ ] Images have descriptive alt text

## Content Quality Validation

**Word Count Verification** (use word count tool on Summary tab content):
- [ ] Chapter 1.1: 400-450 words âœ“
- [ ] Chapter 1.2: 500-550 words âœ“
- [ ] Chapter 1.3: 450-500 words âœ“
- [ ] Chapter 1.4: 450-500 words âœ“
- [ ] Chapter 1.5: 550-600 words âœ“
- [ ] Chapter 1.6: 400-450 words âœ“
- [ ] Chapter 1.7: 300-400 words âœ“

**Summary Content Checklist** (for each chapter):
- [ ] Extracts core concepts from Key Takeaways section
- [ ] Includes 2-3 code examples maximum (not full listings)
- [ ] Includes 1-2 key diagrams
- [ ] Has "Quick Check" self-assessment section
- [ ] Lists prerequisites for next chapter
- [ ] Uses Bloom's Remember/Understand level concepts (not Apply/Analyze depth)

**Code Example Validation**:
- [ ] All code examples in summaries are tested on ROS 2 Humble + Ubuntu 22.04
- [ ] All code examples are syntax-highlighted with language identifier
- [ ] All code examples have brief inline comments

## Performance Testing

**Lighthouse Audit** (run for each chapter):
- [ ] Performance score >90
- [ ] Accessibility score 100 (WCAG 2.1 AA)
- [ ] Best Practices score >90
- [ ] SEO score >90

**Load Time Verification**:
- [ ] Initial page load <2 seconds (10 Mbps connection)
- [ ] Tab switching <1 second
- [ ] No layout shift (Cumulative Layout Shift score <0.1)

**Browser Compatibility**:
- [ ] Chrome latest (test tabs, keyboard, performance)
- [ ] Firefox latest (test tabs, keyboard, performance)
- [ ] Safari latest (test tabs, keyboard, performance)
- [ ] Edge latest (test tabs, keyboard, performance)

---

# Risks and Mitigations

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| Breaking existing chapter rendering | High | Medium | Start with Chapter 1.2 prototype, test thoroughly before rolling out to others |
| Summary content doesn't meet word count targets | Medium | Low | Use word count tool, strict template adherence, peer review |
| Tabs not discoverable by users | Medium | Low | groupId persists selection (better UX), measure SC-001 (locate within 10 seconds) |
| Accessibility issues (keyboard, screen reader) | High | Low | Docusaurus @theme/Tabs has built-in ARIA support, test with NVDA/VoiceOver and keyboard-only |
| Summaries get out of sync with full content | Medium | Medium | Keep both in same .mdx file (single source of truth), add HTML comments linking Summary to Key Takeaways source |
| Performance degradation from tab rendering | Low | Low | Tabs are client-side only, no server impact, Lighthouse audit validates <2s load time |
| MDX conversion breaks existing Markdown features | Medium | Low | Test images, code blocks, links after conversion, Docusaurus MDX fully compatible with CommonMark |

---

# Success Criteria Summary

## Feature Implementation
âœ… All 7 chapters converted from .md to .mdx with tab interface
âœ… All summaries are 300-600 words (verified with word count tool)
âœ… Tabs are keyboard-accessible (Tab/Shift+Tab, Enter/Space)
âœ… Tabs are screen-reader compatible (ARIA roles, tested with NVDA or VoiceOver)
âœ… Default tab is "Content" for all chapters
âœ… groupId persistence works (tab selection syncs across chapters)

## Performance
âœ… Page load time <2 seconds on 10 Mbps connection
âœ… Tab switching <1 second
âœ… Lighthouse score >90 for all chapters
âœ… No layout shift when switching tabs (CLS <0.1)

## Content Quality
âœ… All summaries extract key points from existing Key Takeaways sections
âœ… All summaries include 2-3 code examples maximum
âœ… All code examples tested on ROS 2 Humble + Ubuntu 22.04
âœ… All images have descriptive alt text

## User Experience (Post-Launch Validation)
ðŸ“Š SC-001: Learners can locate and switch to Summary tab within 10 seconds (target: 95% success rate)
ðŸ“Š SC-002: Learners report summaries as "helpful for review" (target: 80%+ positive responses)
ðŸ“Š SC-004: 60%+ of learners revisit Summary tabs before module assessments

---

# Next Steps After Planning

1. âœ… **Planning complete** - This document
2. **Run `/sp.tasks`** to generate granular task breakdown:
   - T001: Convert Chapter 1.2 to .mdx (prototype)
   - T002: Write Chapter 1.2 summary (500-550 words)
   - T003: Test Chapter 1.2 (functional, accessibility, performance)
   - T004-T021: Repeat for Chapters 1.1, 1.3-1.7 (3 tasks per chapter)
   - T022: Full regression testing across all 7 chapters
   - T023: Create tab pattern documentation
3. **Run `/sp.implement`** to execute tasks in phased approach
4. **Test comprehensively** using checklists above
5. **Document pattern** for potential use in Modules 2-4

---

**Plan Status**: âœ… Complete and ready for task generation
**Estimated Implementation Time**: 28-40 hours (prototype 4-6h, core chapters 12-16h, final chapters 6-8h, documentation 2-4h, testing throughout)
